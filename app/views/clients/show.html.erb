<h1><%= @client.name %></h1>
<p>Head office: <%= @client.address %></p>

<% if @current_user && @current_user.admin %>
  <p>
    <%= link_to 'Edit Client', edit_client_path(@client) %> |
    <%= link_to 'Delete Client', client_path(@client), :method => :delete, :data => {confirm: 'Are you sure?'} %>
  </p>
<% end %>

<hr>

<h2>Buildings</h2>

<table>
  <tr>
    <th>Name</th>
    <th>Address</th>
    <th>Reports</th>
    <th>User access</th>
  </tr>
  <% @client.buildings.order('name ASC').each do |building| %>
  <tr>
    <td><%= link_to building.name, building_path(building) %></td>
    <td><%= building.address %></td>
    <td><%= building.reports.length %></td>
    <td>
      <% building.users.each do |user| %>
        <%= user.name %>,
      <% end %>
    </td>
  </tr>
  <% end %>
</table>

<br>

<% if @current_user && @current_user.admin %>
  <%= link_to new_client_building_path(@client) do %>
    <button>Add new building</button>
  <% end %>
<% end %>

<hr>

<h2>Authorized users</h2>
<table>
  <tr>
    <th>Name</th>
    <th>Email</th>
  </tr>
  <% @client.users.each do |user| %>
  <tr>
    <td>
      <% if @current_user == user || @current_user.admin%>
        <%= link_to user.name, user_path(user) %>
      <% else %>
        <%= user.name  %>
      <% end %>
    </td>
    <td><%= user.email %></td>
  </tr>
  <% end %>
</table>

<br>

<button>
  <%= link_to 'Add new user', new_client_user_path(@client) %>
</button>
